{% load staticfiles %}
<head>
  <title>{{title}}</title>
  <link rel="icon" href="/static/img/favicon.png" type="image/x-icon"/>
  <style>
  h4{
    font-size: 30px;
    padding: 0;
    }
    
    @page { 
              size: letter landscape;margin: 2cm;
              @frame header_frame {           /* Static Frame */
                -pdf-frame-content: header_content;
                left: 50pt;
                width: 512pt;
                top: 50pt;
                height: 40pt;
                }

              @frame footer_frame {           /* Another static Frame */
                -pdf-frame-content: footer_content;
                left: 50pt;
                width: 512pt;
                top: 772pt;
                height: 20pt;
              }
          }
     
  .DEVtable{width:25%;overflow: hidden;float: left;border-collapse:collapse;font-size: 8px;}
  .DEVtable caption {font-size: 18px;text-align: center;color: black;font-weight: bold;}
  .DEVtable td{padding: 5px;margin: auto;text-align: center;border:  1px solid;}

   
</style>

</head>

{% block contenido %}
<div id="page-header">
        <div class="header">
            <div class="logo"><img src="/static/img/escudo_lycee2.png" width="150" height="100" /></div> 
            <p class="header-link">
                <a class="header-link" href="http://www.cdegaulle.cl/">www.cdegaulle.cl</a>                
            </p>            
        </div>
</div>

<div id="footer_content">(c) - página <pdf:pagenumber> of <pdf:pagecount> </div>
<h4 align="center">Estadistica de permisos</h4>
<h4 align="center">{{hoy|date:"d-m-Y"}}</h4>
<div id="header_content">{% if start %} Periodo comprendido entre {{inicio|date:"d F Y"}} y {{termino|date:"d F Y"}} {% endif %} </br></div>

{% if permisos %}

  <table border="1" class="DEVtable"> 
            <thead>
                <tr>
                  
                  <th>Correlativo</th>
                  <th>Solicitante</th>
                  <th>Rut</th>
                  <th>Funcion/Cargo</th>
                  <th>Fecha de solicitud</th>
                  <th>Tipo</th>
                  <th>Dia del permiso</th>
                  <th>Motivo</th>
                  <th>Comentario</th>                  
                  <th>Horas</th>
                  <th>Bloques</th>
                  <th>Resolución</th>
                  <th>Devuelve horas</th>
                  <th>Con o sin goce de sueldo</th>
                  <th>Reemplazante</th>
                  <th>Archivo adjunto</th>
                </tr>
              </thead>
            <tbody>   
  {% for permiso in permisos %}
             
            <tr {% if permiso.estado.id == 6 %} class="anulado" {% elif permiso.ultimaResolucion %} {% else %} class="sinrevisar" {% endif %}  >
                <td class="correlativo centrado">{{permiso.id}}</td>
                <td >{{permiso.usuario.apellido1}} {{permiso.usuario.apellido2}} {{permiso.usuario.nombre}}</td>                
                <td >{{permiso.usuario.rut}}-{{permiso.usuario.dv}}</td>
                <td >{{permiso.usuario.cargo}}</td>
                <td class="centrado">{{permiso.fecha_creacion|date:"d-m-Y"}}</td>
                <td >{{permiso.tipo}}</td>
                <td >{{permiso.primerEvento.numero_evento.start|date:"d-m-Y"}}</td>
                <td >{{permiso.motivo}}</td>           
                <td class="ComentarioInforme">{{permiso.comentario}}</td>
                <td class="centrado">{% if permiso.usuario.cargo.id != 19 %} {{permiso.horas_solicitadas}} {% else %} - {% endif %}</td>
                <td class="centrado ">{% if permiso.usuario.cargo.id = 19 %} {{permiso.horas_solicitadas}} {% else %} -  {% endif %}</td>
                <td>{% if permiso.estado.id == 6 %} Anulado {% elif permiso.ultimaResolucion %}{{permiso.ultimaResolucion.get_respuesta_display}} {% else %} Sin revisar{% endif %} </td>
                <td class="centrado">{{ permiso.get_devuelve_horas_display }}</td>
                <td >{{ permiso.get_sueldo_display }}</td>                
                <td >{{permiso.reemplazante}}</td>
                <td class="documentoadjunto centrado">{% if permiso.documento_adjunto.name %} <a target="_blank" href="/media/{{permiso.documento_adjunto}}">Ver Documento</a> {% else %} Sin documento adjunto{% endif %} </td>
                              
            </tr>   

           

  {% empty %}
      <tr>
        <td class="list-group-item">En este momento no hay ningun elemento para mostrar</td>
      </tr>
        {% endfor %}           
        </tbody>    
    </table>
 
  {# .... **Comienzo de la paginacion** .... #}
    {% if is_paginated %}
        <div class="pagination">
            <span class="page-links">
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}"><img width="25px" height="25px" src='/static/img/back.png' alt='Volver'/></a>
                {% endif %}
                <span class="page-current">
                    Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}.
                </span>
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}"><img width="25px" height="25px" src='/static/img/next.png' alt='Siguiente'/></a>
                {% endif %}
            </span>
        </div>
    {% endif %}

{% endif %}


{% endblock %}