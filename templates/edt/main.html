{% extends "edt/base.html" %}
{% load staticfiles %}
<!-- ... -->

{% block contenido %}
<!--  {% for sindicato in en_sindicato %}
{{sindicato}}
{{fech}}
{% endfor %} 

{{usuario.estamento.id}}

{{primaria.id}}
{{maternelle.id}} -->

<!--{{existe_permiso}} - {{inicio_semestre1}} - {{fin_semestre1}} -{{inicio_semestre2}} -{{fin_semestre2}} <br>-->

<!-- {{ContPermisosAdministrativos}}

{% for P in PermisosAdministrativos %}

<span> --> <!-- {{P.id}} <-- </span> 

{% endfor %} -->

<!--<span>Primer Semestre </span>{{primersemestre}}  - <span>Segundo Semestre </span> {{segundosemestre}}
 {{hoy}} ----  {{inicio_semestre2}} -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<a href="#" id="mostrarocultar" name="mostrarocultar" value="mostrarocultar" class="mostrarocultar btn btn-info btn-sm">Click para Mostrar/Ocultar Resumen</a>

<div id="listapermisos" class="listapermisos"> 
	{% if usuarios %}
  <table class=" table-bordered table-hover bgeneral TFtable" >
            <thead>
                <tr>
                  
                  <th class="nombre">Nombre</th>
                  <th>Estamento</th>
                  <th>Horas solicitadas</th>
                  <th>Horas Aprobadas</th>
                  <th>Horas Rechazadas</th>
                  <th>Horas a Recuperar Acumuladas</th>
                  <th>Horas Recuperadas</th>
                  <th>Saldo Horas por Recuperar</th>                  
                  <th>Horas por Descontar Acumuladas</th>
                  <th>Horas Descontadas</th>
                  <th>Saldo Horas por Descontar</th>
                  <th>Horas sin Recuperación con Goce de Sueldo</th>
                  <th>Horas pendientes de Revisión</th>
                  
                </tr>
              </thead>
            <tbody>   
  {% for usuario in usuarios %}

            <tr {% if  usuario.estado == '6' %} class='anulado' {% endif %} >
                <td>{{usuario.apellido1}} {{usuario.apellido2}} {{usuario.nombre}}</td>                
                <td>{{usuario.estamento}}</td>
                <td class="horas">{{usuario.total_horas}}</td>
                <td class="horas">{{usuario.aprobadas}}</td>
                <td class="horas">{{usuario.rechazadas}}</td>
                <td class="horas">{{usuario.devolveracumuladas}}</td>           
                <td class="horas">{{usuario.devueltas}}</td>
                <td class="horas">{{usuario.saldodevolucion}}</td>
                <td class="horas">{{usuario.descontaracumuladas}}</td>
                <td class="horas">{{usuario.descontadas}}</td>                
                <td class="horas">{{usuario.saldodescontar}}</td>
                <td class="horas">{{usuario.sin_recup_con_sueldo}}</td>
                <td class="horas">{{usuario.pendientes_por_aprobar}}</td>
                              
            </tr>       

            <!-- <tr>
                <td>{{resolucion.id }}</td>
                <td>{% if resolucion.ultimaResolucion %} {{ resolucion.ultimaResolucion.get_respuesta_display }}  {% endif %}</td>
                <td></td>
                <td></td>

            </tr> -->

  {% empty %}
      <tr>
        <td class="list-group-item">En este momento no hay ningun elemento para mostrar</td>
      </tr>
        {% endfor %}           
        </tbody>    
    </table>
 
  {# .... **Comienzo de la paginacion** .... #}
    {% if is_paginated %}
        <div class="pagination">
            <span class="page-links">
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}"><img width="25px" height="25px" src='/static/img/back.png' alt='Volver'/></a>
                {% endif %}
                <span class="page-current">
                    Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}.
                </span>
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}"><img width="25px" height="25px" src='/static/img/next.png' alt='Siguiente'/></a>
                {% endif %}
            </span>
        </div>
    {% endif %}

{% endif %}




<table class=" table-bordered table-hover bgeneral TFtable" >
            <thead>
                <tr>  
                  <th></th>
                  <th>Fecha</th>
                  <th>Tipo</th>
                  <th>Horas solicitadas</th>
                  <th>Horas Aprobadas</th>
                  <th>Horas Rechazadas</th>
                  <th>Horas a Recuperar Acumuladas</th>
                  <th>Horas Recuperadas</th>
                  <th>Saldo Horas por Recuperar</th>                  
                  <th>Horas por Descontar Acumuladas</th>
                  <th>Horas Descontadas</th>
                  <th>Saldo Horas por Descontar</th>
                  <th>Horas sin Recuperación con Goce de Sueldo</th>
                  <th>Horas pendientes de Revisión</th>                  
                </tr>
              </thead>
            <tbody>
{% for hora in horas %}
			<tr {% if  hora.permiso.estado.id == 6 %} class='anulado' {% endif %} >
                <td class="horas">
                	<a class="list-group-item" href="{% url 'edt.views.verpermiso2' hora.permiso.pk %}"> {{forloop.counter}}</a>
                </td>
     			<td class="horas">{{ hora.permiso.primerEvento.numero_evento.start |date:"d F Y" }}</td>	                
                <td class="horas">{{hora.permiso.tipo}}</td>
                <td class="horas negrita">{{hora.horas_solicitadas}}</td>
                <td class="horas">{{hora.horas_aprobadas}}</td>
                <td class="horas">{{hora.horas_rechazadas}}</td>
                <td class="horas">{{hora.horas_por_devolver_acumuladas}}</td>           
                <td class="horas">{{hora.horas_devueltas}}</td>
                <td class="horas negrita">{{hora.horas_por_devolver}}</td>
                <td class="horas">{{hora.horas_descontar_acumuladas}}</td>
                <td class="horas">{{hora.horas_descontadas}}</td>                
                <td class="horas negrita">{{hora.horas_descontar}}</td>
                <td class="horas">{{hora.horas_sin_recuperacion_con_goce}}</td>
                <td class="horas">{{hora.horas_pendientes_por_aprobar}}</td>
                              
            </tr>

{% endfor %}
</tbody>    
    </table>

</div>

<form id="main" name="main" class="form-horizontal" action="/urlcalendario/" method="post" enctype="multipart/form-data">
	<div  class="permiso" >
		<div id="frmpermiso">	
		{{form.tipo.errors}}
		<p><label for="tipo" >Tipo de Permiso<br/> a solicitar</label>{{form.tipo}}</p>
		</div>

  
  		<div id="frmpermiso">
  		{{form.devuelve_horas.errors}}
  		<p class="devuelve_horas"><label for="fecha_devuelve_horas">Me comprometo a recuperar <br/> la(s) hora(s) </label>{{form.devuelve_horas}}</p>
  		</div>
  		<div id="frmpermiso">
  		{{form.sueldo.errors}}
  		<p class="sueldo"><label for="sueldo">Solicitud con o sin <br/>goce de sueldo</label>{{form.sueldo}}</p>
  		</div>
 
	</div>

	<div class="permiso">
		<div id="frmpermiso">
      {{form.motivo.errors}}
		<p><label for="motivo" >Motivo</label>{{form.motivo}}</p>
		</div>	
		<div id="frmpermiso">
		{{form.comentario.errors}}
		<p><label for="comentario">Comentario / Cuando devolvera horas:</label>{{form.comentario}}</p>
		</div>	
		<div id="frmpermiso">
		<p class="reemplazante"><label for="reemplazante">Propuesta de Reemplazante</label>{{form.reemplazante}}</p>
		</div>	
		<div id="frmpermiso">
		<p class="documento_adjunto"><label for="documento_adjunto" title="El nombre del archivo adjunto no debe contener tildes ni ñ">Documento adjunto</label>{{form.documento_adjunto}}</p>	
		</div>		

	</div>
	<div class="alert alert-warning">IMPORTANTE : La anulación de un permiso solo se efectua a través de su jefatura directa, quien debera solicitarla a RRHH.</div>	
	<div id='calendar'></div>
		<input type="hidden" id="calendario-data" name="data-calendario">
    <input type="hidden" id="usuario-data" name="data-usuario">

	<input class="btn btn-success btn-lg" type="submit" value="Solicitar" name="Solicitar" id="botonCalendario"/>

<div class="modal fade matrimonio" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Matrimonio o acuerdo de unión civil</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>5 días hábiles continuos.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>En el día del matrimonio y en los días inmediatamente anteriores o posteriores al de la celebración civil.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>Se debe avisar con 30 días de anticipación.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Dentro de los 30 días siguientes a la celebración el certificado de matrimonio del Servicio de Registro Civil e Identificación.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Sin restricciones.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal matrimonio-->

<div class="modal fade mamografia" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Examen de mamografía</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>Medio día.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>una vez al año.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>Se debe avisar con una semana de anticipación.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Con posterioridad, los comprobantes que acrediten que se los realizó en la fecha estipulada.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Trabajadoras mayores de 40 años, con contrato superior a 30 días.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal mamografia-->

<div class="modal fade prostata" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Examen de Próstata</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>Medio día.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>una vez al año.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>Se debe avisar con una semana de anticipación.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Con posterioridad, los comprobantes que acrediten que se los realizó en la fecha estipulada.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Trabajadores mayores de 50 años, con contrato superior a 30 días.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal prostata-->

<div class="modal fade fallecimientopadreomadre" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Fallecimiento del Padre o la Madre del trabajador</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>3 días hábiles.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>A partir del respectivo fallecimiento.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>No aplica.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Ninguno.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Ninguna.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal fallecimientopadreomadre-->

<div class="modal fade fallecimientohijoengestacion" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Fallecimiento de un hijo en período de gestación</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>3 días hábiles.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>A partir del respectivo fallecimiento.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>No aplica.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Ninguno.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Ninguna.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal fallecimientohijoengestacion -->

<div class="modal fade fallecimientoconyuge" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Fallecimiento del cónyuge o conviviente civil</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>7 días corridos.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>A partir del respectivo fallecimiento.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>No aplica.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Ninguno.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Ninguna.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>El funcionario cuenta con 1 mes de fuero laboral a contar del respectivo fallecimiento.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal fallecimientoconyuge -->

<div class="modal fade fallecimientohijo" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>Fallecimiento de un hijo </h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>7 días corridos.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>A partir del respectivo fallecimiento.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>No aplica.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Ninguno.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Ninguna.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>El funcionario cuenta con 1 mes de fuero laboral a contar del respectivo fallecimiento.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal fallecimientohijo-->

<div class="modal fade padrenacimientohijo" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>El padre por nacimiento de un hijo</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Duración : </label>
          <div><span>5 días.</span></div>
        </div>
        <div>
          <label >¿Cuándo solicitar? : </label>
          <div><span>Desde el momento del parto de forma continua o distribuirlo dentro del primer mes desde la fecha de nacimiento.</span></div>
        </div>
        <div>
          <label c>¿Cuándo dar aviso? : </label>
          <div><span>Solicitar por escrito.</span></div>
        </div>
        <div>
          <label>Documentación a presentar : </label>
          <div><span>Certificado de nacimiento.</span></div>
        </div>  
        <div>
          <label >Restricción : </label>
          <div><span>Debe solicitarlo y hacer uso del permiso dentro del primer mes desde la fecha de nacimiento.</span></div>
        </div>          
        <div>
          <label>Observación</label>
          <div><span>Sin observaciones.</span></div>
        </div>        
      </div>

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal padrenacimientohijo  -->

<div class="modal fade requisitosmamografia" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>No cumple con requisitos para solicitar este permiso</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Requisitos :  </label>
          <div><span>trabajadoras mayores de 40 años, con contrato superior a 30 días</span></div>
        </div>
       </div> 
        <div class="modal-footer">        
          <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
        </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal requisitosmamografia  -->

<div class="modal fade requisitosprostata" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>No cumple con requisitos para solicitar este permiso</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Requisitos :  </label>
          <div><span>trabajadores mayores de 50 años, con contrato superior a 30 días</span></div>
        </div>
       </div> 
      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal requisitosprostata  -->

<div class="modal fade permisoadministrativo" tabindex="-1" role="dialog" aria-labelledby="mymModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" id="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>REQUISITOS Y CONSIDERACIONES</h4>
      </div>

      <div class="modal-body">
        <div>
          <label >Importante!</label>
          <div><span><li>Deberá pedirse con a lo menos una semana de anticipación, salvo caso fortuito o fuerza mayor.</li></span></div>
      <br>
      <div><span><li>No podrá, salvo fuerza mayor, ser solicitado en víspera de fin de semana con festivo, ni después de este, tampoco durante días o jornadas de capacitaciones, días de permanencias, ni tampoco en días viernes o lunes.</li></span></div>
      <br>
      <div><span><li>En caso de no utilizarse dentro del semestre respectivo, no se acumulará para el semestre siguiente.</li></span></div>
      <br>
      <div><span><li>En caso de producirse problemas administrativos que deriven en la imposibilidad de cubrir el servicio prestados por el trabajador requirente, cuando no se trate de una fuerza mayor, el colegio podrá negarse a su otorgamiento para uno o más trabajadores, sin perjuicio de lo cual propondrá otro día para hacer uso del permiso.</li></span></div>
        </div>

        </div>        

      <div class="modal-footer">
        
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal permisoadministrativo -->


	</form>
<script>
var usuario = {{usuario.id}};
var seleccionados = [];
console.log ("usuario", usuario);
$(document).ready(function(){
	$( "input[type=file]" ).last().addClass( "custom-file-input" );
  $('label[title]').qtip();
	$('#calendar').fullCalendar({
       // put your options and callbacks here   
       selectable:true,
       selectHelper:true,
       unselectAuto:false,
       // minTime:"00:00:00",
       // maxTime : '00:00:00',
       height: "auto",
       lang: 'es',
       timezone:'America/Santiago',
       defaultView: 'agendaWeek',
       schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
       header:
	       {
	       left:   'title',
	       center: '',
	       right:  'month agendaWeek agendaDay  prev,next'
	       },
       weekends: true,
       businessHours:true, 
       businessHours:
	       {
		   start: '08:00', // a start time (10am in this example)
	   	   end: '22:30', // an end time (6pm in this example)
	   	   dow: [ 1, 2, 3, 4 , 5, 6]	
	   	   },
	events: 'http://cal.cdegaulle.cl/wsCalendari/',	

	eventAfterRender: function(event,element){

    $(element).removeClass('fc-short');

		if(event.used){
			$(element).css('background','red');
			$(element).css('font-weight', 'bold');
			$(element).css('border-color','black');
			$(element).css('border','3');
			}	
	},
	 
   	   eventClick: function(event){
   	  var hoy = new Date();
			var dd = hoy.getDate();
			var mm = hoy.getMonth()+1; //hoy es 0!
			var yyyy = hoy.getFullYear();
			var ms = hoy.getTime();
			if(dd<10) {dd='0'+dd} 
			if(mm<10) {mm='0'+mm} 
			hoy = mm+'/'+dd+'/'+yyyy;
			var dosdias = 172800; 
			var fecha_actual = new Date(ms);
			var fecha_actualMsec = fecha_actual.getMilliseconds();

			var fecha_evento = new Date(event.start);
			var fecha_eventoMsec = fecha_evento.getMilliseconds();
			var diferencia = ((fecha_evento - fecha_actual )/1000); // calculada en milisegundos
			
			// console.log(fecha_actual);
			// console.log (fecha_evento);
			// console.log("Diferencia" , diferencia);
			
	   	// Comprueba si el permiso se pide con 48 horas de anticipacion
	  // if(diferencia < dosdias && fecha_actual < fecha_evento ){
	  // 	alert("El permiso dede ser solicitado con la menos 48 horas de anticipacion")
	  	
	  // }else{		    
	  	//revisa si no esta en la lista
	   if(seleccionados.indexOf(event.id) == -1 && (event.used == false))  {
			seleccionados.push(event.id);
			$(this).css('background', '#00FF05');
			$(this).css('font-weight', 'bold');
			$(this).css('color', 'black');

		}else if (event.used == false){ // si ya esta lo quitamos y reseteamos el color
									
			seleccionados.splice(seleccionados.indexOf(event.id),1);
			$(this).css('background', '#3498DB');
			$(this).css('color', '#ffffff');
			$(this).css('font-weight', 'bold');
			

			}
				//console.log(event.start);
				var ordenado = seleccionados.sort();//ordeno el arreglo para su correcto guadado
				console.log(ordenado);
			// }	//fin comprobacion de 48 horas	
								}, // end fullcalendar       						 		
		
		})//end function 
})// end ready
</script>
<script type="text/javascript">
  var edad ={{edad}};
  var sexo = {{sexo}};
  var primaria = {{primaria.id}};
  var maternelle = {{maternelle.id}};
  var estamento = {{usuario.estamento.id}};
  var primersemestre = {{primersemestre}};
  var segundosemestre = {{segundosemestre}};
  console.log("edad",edad);
  console.log("Sexo",sexo);
  console.log("Primaria",primaria);
  console.log("maternelle",maternelle);
  console.log("estamento",estamento);

$(document).ready(function(){

	$("#mostrarocultar").click(function(){
        $("#listapermisos").toggle();
    });

  
  function reset_select(){
      $("#id_devuelve_horas").empty()
      $("#id_sueldo").empty();
      $("#id_motivo").empty();
  }

  function reactiva_select(){

      $("#id_devuelve_horas").prop( "readonly", false );
      $("#id_devuelve_horas").append('<option value="" selected="selected">---------</option>');
      $("#id_devuelve_horas").append('<option value="S">SI</option>');
      $("#id_devuelve_horas").append('<option value="N">NO</option>');
      $("#id_sueldo").prop( "readonly", false );
      $("#id_sueldo").append('<option value="" selected="selected">---------</option>');
      $("#id_sueldo").append('<option value="C">Con goce de suedo</option>');
      $("#id_sueldo").append('<option value="S">Sin goce de suedo</option>');
      
  }

  function carga_select_default(){
      $("#id_motivo").append('<option value="" selected="selected">---------</option>');
      $("#id_motivo").append('<option value="1">Motivo Personal</option>');
      $("#id_motivo").append('<option value="2">Compromisos Laborales con otro empleador</option>');
      $("#id_motivo").append('<option value="3">Enfermedad</option>');
      $("#id_motivo").append('<option value="4">Hora Médico</option>');
      $("#id_motivo").append('<option value="5">Hora medico de un familiar</option>');
      $("#id_motivo").append('<option value="6">Exámenes médicos</option>');
      $("#id_motivo").append('<option value="7">Exámenes médicos de un familiar</option>');
      $("#id_motivo").append('<option value="8">Urgencia medica</option>');
      $("#id_motivo").append('<option value="9">Urgencia médica de un familiar</option>');
      $("#id_motivo").append('<option value="10">Funerales</option>');
      $("#id_motivo").append('<option value="11">Viaje</option>');
      $("#id_motivo").append('<option value="12">Trámites legales y/o municipales</option>');
      $("#id_motivo").append('<option value="13">Graduación de un familiar</option>');
      $("#id_motivo").append('<option value="14">Otros</option>');
  } 

  function carga_select_legales(){
      $("#id_motivo").append('<option value="" selected="selected">---------</option>');
      $("#id_motivo").append('<option value="15">Matrimonio o acuerdo de unión civil</option>');
      $("#id_motivo").append('<option value="16">Examen de mamografía</option>');
      $("#id_motivo").append('<option value="17">Examen próstata</option>');
      $("#id_motivo").append('<option value="18">Fallecimiento del Padre o la Madre del trabajador</option>');
      $("#id_motivo").append('<option value="19">Fallecimiento de un hijo en período de gestación</option>');
      $("#id_motivo").append('<option value="20">Fallecimiento del cónyuge o conviviente civil</option>');
      $("#id_motivo").append('<option value="21">Fallecimiento de un hijo</option>');
      $("#id_motivo").append('<option value="22">Nacimiento de un hijo</option>');
      $("#id_motivo").append('<option value="24">Vacunación Covid</option>');
  }
  function bloquea_select(){
      $("#id_devuelve_horas").prop( "readonly", true );
      $("#id_devuelve_horas").empty().append('<option selected value="N">NO</option>');
      $("#id_sueldo").prop( "readonly", true );
      $("#id_sueldo").empty().append('<option selected value="C">Con goce de sueldo</option>');
      $("#id_motivo").empty();
  }

  function bloquea_select_primaria(){
      $("#id_devuelve_horas").prop( "readonly", true );
      $("#id_devuelve_horas").empty().append('<option selected value="N">No devuelve horas</option>');
      $("#id_sueldo").prop( "readonly", true );
      $("#id_sueldo").empty().append('<option selected value="S">Sin goce de sueldo</option>');
      $("#id_motivo").empty();
  }

  if (estamento == primaria || estamento == maternelle){
      bloquea_select_primaria();
  }


  $("#id_tipo").change(function(e){
    
    if($("#id_tipo").val() == 4 ){
      bloquea_select();
      carga_select_legales();

    } else if($("#id_tipo").val() == 5){
      reset_select();      
      bloquea_select();
      carga_select_default();

      if (primersemestre  >= 1 ){
        swal("Atención" , "Permiso Adminstrativo del 1er. Semestre ya solicitado", "error");
        document.querySelector('#botonCalendario').disabled = true;
        e.preventDefault(); 
      };

      if (segundosemestre  >= 1 ){
        swal("Atención", "Permiso Adminstrativo del 2do. Semestre ya solicitado", "error");
        document.querySelector('#botonCalendario').disabled = true;
        e.preventDefault(); 
      };

      if (segundosemestre  != 1 && primersemestre  >= 1 ){
        swal("Atención", "Permiso Adminstrativo del 1er. Semestre ya solicitado", "error");
        document.querySelector('#botonCalendario').disabled = false;
        e.preventDefault(); 
      };

      if (segundosemestre  >= 1 && primersemestre  >= 1 ){
        swal("Atención", "Ya ha solicitado todos los Permisos Administrativos permitidos", "error");
        document.querySelector('#botonCalendario').disabled = true;
        e.preventDefault(); 
      };


      $('.permisoadministrativo').modal('show');

    }else{
          reset_select();
          reactiva_select();
          carga_select_default();
          document.querySelector('#botonCalendario').disabled = false;

    }//fin else

  });

 $("#id_motivo").change(function(e){
  
  if($("#id_motivo").val() == 15){
    $('.matrimonio').modal('show');
    }

  if($("#id_motivo").val() == 16 && edad >= 40 && sexo == 2){
    $('.mamografia').modal('show');
  }
  if ( ($("#id_motivo").val() == 16 && edad < 40  && sexo == 2) || ( $("#id_motivo").val() == 16 && edad >= 40 && sexo == 1) || ($("#id_motivo").val() == 16 && edad < 40 && sexo == 1 ) ){

    $('.requisitosmamografia').modal('show');
      e.preventDefault();
  } 
  
  if($("#id_motivo").val() == 17 && edad >= 50 && sexo == 1 ){
    $('.prostata').modal('show');
   }

   if ( ($("#id_motivo").val() == 17 && edad < 50  && sexo == 1) || ( $("#id_motivo").val() == 17 && edad >= 50 && sexo == 2) || ($("#id_motivo").val() == 17 && edad < 50 && sexo == 2 ) ){
    
    $('.requisitosprostata').modal('show');
      e.preventDefault();
      console.log("entre");
  }  
  
  if($("#id_motivo").val() == 18){
    $('.fallecimientopadreomadre').modal('show');

  }
  
  if($("#id_motivo").val() == 19){
    $('.fallecimientohijoengestacion').modal('show');

  }
  
  if($("#id_motivo").val() == 20){
    $('.fallecimientoconyuge').modal('show');

  }
  
  if($("#id_motivo").val() == 21){
    $('.fallecimientohijo').modal('show');

  }

  if($("#id_motivo").val() == 22){
    $('.padrenacimientohijo').modal('show');

  }

});



$("#main").submit(function(e){
		if(seleccionados.length == 0){
			alert("Debe seleccionar al menos un bloque de su horario");
			e.preventDefault();
		}
  });

$('#main').ready(function(e){
  if($('#{{form.comentario.id_for_label}}').val() == ' ') {
    alert("Debe Ingresar un Comentario");
      e.preventDefault();
  }
});

// $('#main').submit(function(e){
//     if($('#id_devuelve_horas').val() == "S" && $('#id_sueldo').val() =="S" && $('#id_tipo').val() < 3)
//       alert("Permiso CON DEVOLUCIÓN de horas debe ser CON GOCE de sueldo");
//               e.preventDefault(e);

//   });
 
    
  $('#main').submit(function(e){
	   if( $('#id_devuelve_horas').val() == "N" && $('#id_sueldo').val() == "C" && $('#id_tipo').val() < 3   ){
        alert("Permiso SIN DEVOLUCIÓN de horas debe ser SIN GOCE de sueldo");
              e.preventDefault();
    }  
  $("#calendario-data").val(JSON.stringify(seleccionados));

  });          

});

</script>   
{% endblock  %}